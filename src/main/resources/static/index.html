<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Factures</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">Connexion</h2>
            <form id="authForm">
                <div class="form-group">
                    <label for="authUsername">Nom d'utilisateur</label>
                    <input type="text" id="authUsername" required>
                </div>
                <div class="form-group">
                    <label for="authPassword">Mot de passe</label>
                    <input type="password" id="authPassword" required>
                </div>
                <div id="authError" class="error-message"></div>
                <button type="submit" class="btn-primary" id="authSubmitBtn">Se connecter</button>
            </form>
            <p class="auth-toggle">
                <span id="toggleText">Pas encore de compte ?</span>
                <a href="#" id="toggleAuthMode">S'inscrire</a>
            </p>
        </div>
    </div>

    <div class="container" id="appContainer" style="display: none;">
        <header>
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h1>Factures</h1>
                    <p class="subtitle">Gérez vos factures simplement et efficacement.</p>
                </div>
                <div>
                    <span id="currentUser" style="margin-right: 1rem; color: var(--text-secondary);"></span>
                    <button id="logoutBtn" class="btn-secondary">Déconnexion</button>
                </div>
            </div>
        </header>

        <main>
            <nav class="tabs">
                <button id="showInvoicesBtn" class="tab-btn active">Factures</button>
                <button id="showClientsBtn" class="tab-btn">Clients</button>
                <button id="showProductsBtn" class="tab-btn">Produits Robotiques</button>
            </nav>

            <div id="invoicesView">
                <section class="card form-section">
                    <h2>Nouvelle Facture</h2>
                    <form id="invoiceForm">
                        <div class="form-group">
                            <label for="clientSelect">Client</label>
                            <select id="clientSelect" name="clientId" required>
                                <option value="">Sélectionner un client</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="issueDate">Date</label>
                            <input type="date" id="issueDate" name="issueDate" required>
                        </div>
                        <div class="form-group">
                            <label for="status">Statut</label>
                            <select id="status" name="status">
                                <option value="PENDING">En attente</option>
                                <option value="PAID">Payée</option>
                                <option value="CANCELLED">Annulée</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label>Lignes de Facture</label>
                            <div class="form-row" style="align-items: flex-end;">
                                <div class="form-group" style="flex: 2;">
                                    <label for="productSelect" style="font-size: 0.9rem;">Produit</label>
                                    <select id="productSelect">
                                        <option value="">Choisir un produit</option>
                                    </select>
                                </div>
                                <div class="form-group" style="flex: 1;">
                                    <label for="quantityInput" style="font-size: 0.9rem;">Quantité</label>
                                    <input type="number" id="quantityInput" min="1" value="1">
                                </div>
                                <button type="button" id="addLineBtn" class="btn-secondary"
                                    style="margin-bottom: 1.5rem;">Ajouter</button>
                            </div>

                            <div class="lines-preview">
                                <table id="linesTable">
                                    <thead>
                                        <tr>
                                            <th>Produit</th>
                                            <th>Qté</th>
                                            <th>Prix Unit.</th>
                                            <th>Total Ligne</th>
                                            <th>Action</th>
                                        </tr>
                                    </thead>
                                    <tbody id="linesList"></tbody>
                                    <tfoot>
                                        <tr>
                                            <td colspan="3" style="text-align: right; font-weight: bold;">Total Facture
                                                :</td>
                                            <td id="totalPreview" style="font-weight: bold;">0.00 €</td>
                                            <td></td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>

                        <button type="submit" class="btn-primary">Créer la facture</button>
                    </form>
                </section>

                <section class="card list-section">
                    <div class="list-header">
                        <h2>Liste des Factures</h2>
                        <button id="refreshBtn" class="btn-icon" title="Actualiser">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M23 4v6h-6"></path>
                                <path d="M1 20v-6h6"></path>
                                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Client</th>
                                    <th>Date</th>
                                    <th>Montant</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="invoiceList"></tbody>
                        </table>
                    </div>
                </section>
            </div>

            <div id="clientsView" style="display: none;">
                <section class="card form-section">
                    <h2>Nouveau Client</h2>
                    <form id="clientForm">
                        <div class="form-group">
                            <label for="clientNameInput">Nom</label>
                            <input type="text" id="clientNameInput" name="name" placeholder="Nom de l'entreprise"
                                required>
                        </div>
                        <div class="form-group">
                            <label for="clientEmail">Email</label>
                            <input type="email" id="clientEmail" name="email" placeholder="contact@entreprise.com">
                        </div>
                        <div class="form-group">
                            <label for="clientAddress">Adresse</label>
                            <input type="text" id="clientAddress" name="address" placeholder="Adresse complète">
                        </div>
                        <button type="submit" class="btn-primary">Ajouter le client</button>
                    </form>
                </section>

                <section class="card list-section">
                    <div class="list-header">
                        <h2>Liste des Clients</h2>
                        <button id="refreshClientsBtn" class="btn-icon" title="Actualiser">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M23 4v6h-6"></path>
                                <path d="M1 20v-6h6"></path>
                                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nom</th>
                                    <th>Email</th>
                                    <th>Adresse</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="clientList"></tbody>
                        </table>
                    </div>
                </section>
            </div>

            <div id="productsView" style="display: none;">
                <section class="card form-section">
                    <h2>Nouveau Produit</h2>
                    <form id="productForm">
                        <div class="form-group">
                            <label for="productName">Nom du Produit</label>
                            <input type="text" id="productName" name="name" placeholder="Ex: Bras Robotique X200"
                                required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="productCategory">Catégorie</label>
                                <select id="productCategory" name="category">
                                    <option value="Industriel">Industriel</option>
                                    <option value="Domestique">Domestique</option>
                                    <option value="Composant">Composant</option>
                                    <option value="Logiciel">Logiciel</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="productPrice">Prix</label>
                                <input type="number" id="productPrice" name="price" step="0.01" placeholder="0.00"
                                    required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="productStock">Stock Initial</label>
                            <input type="number" id="productStock" name="stock" placeholder="0" required>
                        </div>
                        <button type="submit" class="btn-primary">Ajouter le produit</button>
                    </form>
                </section>

                <section class="card list-section">
                    <div class="list-header">
                        <h2>Catalogue Produits</h2>
                        <button id="refreshProductsBtn" class="btn-icon" title="Actualiser">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M23 4v6h-6"></path>
                                <path d="M1 20v-6h6"></path>
                                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                            </svg>
                        </button>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Nom</th>
                                    <th>Catégorie</th>
                                    <th>Prix</th>
                                    <th>Stock</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="productList"></tbody>
                        </table>
                    </div>
                </section>
            </div>
        </main>
    </div>
    <script src="app.js"></script>
</body>

</html>